# Stage 1 ‚Äî build
FROM node:20.11.0-alpine AS build

WORKDIR /app

# üëá –¥–æ–±–∞–≤–ª—è–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç
ARG VITE_SERVER_URL

# üëá —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –µ–≥–æ –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
ENV VITE_SERVER_URL=$VITE_SERVER_URL

COPY package*.json ./
RUN npm install

COPY . .

# üëá —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ Vite –ø—Ä–∏ —Å–±–æ—Ä–∫–µ
RUN npm run build


# Stage 2 ‚Äî serve
FROM nginx:alpine

COPY --from=build /app/dist /usr/share/nginx/html
CMD ["nginx", "-g", "daemon off;"]
